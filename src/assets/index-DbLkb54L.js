import{_ as e,a,r as l,e as r,c as s,b as t,f as o,g as u,w as i,k as d,l as n,h as c,j as m,t as p,M as g,s as v,m as f}from"./index-DffehwHv.js";const _={class:"register-container"},b={class:"register-box"},h=["src"],y={class:"form-actions"},w={class:"register-links"},k=e({__name:"index",setup(e){const k=a(),V=l({mobile:"",code:"",password:"",nickname:"",avatar:"",avatar_url:""}),x=l(),q=l(0);let z=null;const U={mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"验证码为6位",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不少于6位",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],avatar_url:[{required:!0,message:"请上传头像",trigger:"change"}]};async function C(){await x.value.validateField("mobile");try{const e=V.value.mobile;await v({mobile:e,smsType:"register"})}catch(e){return void g.error(e.message)}q.value=60,z=setInterval((()=>{q.value--,q.value<=0&&clearInterval(z)}),1e3)}function I(e){const a=e.type.startsWith("image/"),l=e.size/1024/1024<5;return a?!!l||(g.error("图片大小不能超过5MB!"),!1):(g.error("只能上传图片文件!"),!1)}function j(e){V.value.avatar_url=e.data.url}async function M(){await x.value.validate();try{await f(V.value);g.success("注册成功"),B()}catch(e){console.log(e),g.error(e.message)}}function B(){k.push("/login")}return(e,a)=>{const l=r("el-icon"),g=r("el-upload"),v=r("el-form-item"),f=r("el-input"),k=r("el-button"),z=r("el-form"),F=r("el-link");return t(),s("div",_,[o("div",b,[a[8]||(a[8]=o("div",{class:"register-header"},[o("h2",{class:"register-title"},"注册新账号")],-1)),u(z,{model:V.value,rules:U,ref_key:"formRef",ref:x,"label-width":"0"},{default:i((()=>[u(v,{prop:"avatar_url"},{default:i((()=>[u(g,{class:"avatar-uploader",action:d(n)+"/common/upload","show-file-list":!1,"before-upload":I,"on-success":j},{default:i((()=>[V.value.avatar_url?(t(),s("img",{key:0,src:V.value.avatar_url,class:"avatar"},null,8,h)):(t(),c(l,{key:1,class:"avatar-uploader-icon"},{default:i((()=>a[4]||(a[4]=[o("i",{class:"el-icon-user"},null,-1)]))),_:1}))])),_:1},8,["action"])])),_:1}),u(v,{prop:"nickname"},{default:i((()=>[u(f,{modelValue:V.value.nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value.nickname=e),placeholder:"请输入昵称",size:"large"},null,8,["modelValue"])])),_:1}),u(v,{prop:"mobile"},{default:i((()=>[u(f,{modelValue:V.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value.mobile=e),placeholder:"请输入手机号",maxlength:"11",size:"large"},null,8,["modelValue"])])),_:1}),u(v,{prop:"code"},{default:i((()=>[u(f,{modelValue:V.value.code,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value.code=e),placeholder:"请输入验证码",maxlength:"6",size:"large"},{suffix:i((()=>[u(k,{type:"primary",disabled:q.value>0,onClick:C},{default:i((()=>[m(p(q.value>0?q.value+"s后重试":"获取验证码"),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1}),u(v,{prop:"password"},{default:i((()=>[u(f,{modelValue:V.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value.password=e),placeholder:"请设置密码","show-password":"",size:"large"},null,8,["modelValue"])])),_:1}),o("div",y,[u(k,{type:"primary",style:{width:"100%"},onClick:M},{default:i((()=>a[5]||(a[5]=[m("注册")]))),_:1})])])),_:1},8,["model"]),o("div",w,[a[7]||(a[7]=o("span",{class:"no-account"},"已有账号?",-1)),u(F,{type:"primary",onClick:B},{default:i((()=>a[6]||(a[6]=[m("立即登录")]))),_:1})])])])}}},[["__scopeId","data-v-5c06dd5f"]]);export{k as default};
