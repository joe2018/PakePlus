import{_ as e,a,r as l,e as s,c as r,b as o,f as t,g as d,w as u,j as i,t as n,s as m,p as c}from"./index-DffehwHv.js";const g={class:"reset-container"},p={class:"reset-box"},v={class:"form-actions"},f={class:"reset-links"},b=e({__name:"index",setup(e){const b=a(),w=l({mobile:"",code:"",password:"",confirmPassword:""}),_=l(),h=l(0);let y=null;const V={mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"验证码为6位",trigger:"blur"}],password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{min:6,message:"密码长度不少于6位",trigger:"blur"},{validator:(e,a,l)=>{a!==w.value.password?l(new Error("两次输入的密码不一致")):l()},trigger:"blur"}]};async function x(){await _.value.validateField("mobile");try{const e=w.value.mobile;await m({mobile:e,smsType:"register"})}catch(e){return console.log(e),void Message.error(e.message)}h.value=60,y=setInterval((()=>{h.value--,h.value<=0&&clearInterval(y)}),1e3)}async function k(){await _.value.validate();try{await c(w.value);Message.success("重置密码成功"),P()}catch(e){console.log(e),Message.error(e.message)}}function P(){b.push("/login")}return(e,a)=>{const l=s("el-input"),m=s("el-form-item"),c=s("el-button"),b=s("el-form"),y=s("el-link");return o(),r("div",g,[t("div",p,[a[6]||(a[6]=t("h2",{class:"reset-title"},"找回密码",-1)),d(b,{model:w.value,rules:V,ref_key:"formRef",ref:_,"label-width":"0",size:"large"},{default:u((()=>[d(m,{prop:"mobile"},{default:u((()=>[d(l,{modelValue:w.value.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value.mobile=e),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])])),_:1}),d(m,{prop:"code"},{default:u((()=>[d(l,{modelValue:w.value.code,"onUpdate:modelValue":a[1]||(a[1]=e=>w.value.code=e),placeholder:"请输入验证码",maxlength:"6"},{suffix:u((()=>[d(c,{type:"primary",size:"middle",disabled:h.value>0,onClick:x},{default:u((()=>[i(n(h.value>0?h.value+"s后重试":"获取验证码"),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1}),d(m,{prop:"password"},{default:u((()=>[d(l,{modelValue:w.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value.password=e),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])])),_:1}),d(m,{prop:"confirmPassword"},{default:u((()=>[d(l,{modelValue:w.value.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>w.value.confirmPassword=e),placeholder:"请确认新密码","show-password":""},null,8,["modelValue"])])),_:1}),t("div",v,[d(c,{type:"primary",style:{width:"100%"},onClick:k},{default:u((()=>a[4]||(a[4]=[i("重置密码")]))),_:1})])])),_:1},8,["model"]),t("div",f,[d(y,{type:"info",onClick:P},{default:u((()=>a[5]||(a[5]=[i("返回登录")]))),_:1})])])])}}},[["__scopeId","data-v-1048f739"]]);export{b as default};
