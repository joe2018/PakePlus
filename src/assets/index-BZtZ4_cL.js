import{_ as e,a,u as l,r as s,d as o,o as r,e as u,c as i,b as t,f as d,n,g as m,w as c,h as v,i as p,j as g,t as b,s as f,M as y}from"./index-CWW7rXlu.js";const h={class:"login-container"},_={class:"login-box"},w={class:"login-tabs"},k={class:"tab-header"},V={key:2,class:"form-options"},x={class:"form-actions"},M={class:"login-links"},C=e({__name:"index",setup(e){const C=a(),F=l(),U=s("0"),q=s({mobile:"",password:"",code:"",rememberMe:!1}),z=s(!1),I=s(),j=s(0);let R=null;const L=o((()=>{const e={mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}]};return"0"===U.value?{...e,password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]}:"1"===U.value?{...e,code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"验证码长度为6位",trigger:"blur"}]}:e}));async function T(){await I.value.validate();try{z.value=!0,await F.doLogin({...q.value,rememberMe:q.value.rememberMe,type:U.value}),async function(){C.replace("/main")}()}catch(e){console.log(e)}finally{z.value=!1}}async function $(){await codeFormRef.value.validateField("mobile");try{const e=codeForm.value.mobile;await f({mobile:e,smsType:"login"}),y.success("发送成功")}catch(e){return void y.error(e.message)}j.value=60,R=setInterval((()=>{j.value--,j.value<=0&&clearInterval(R)}),1e3)}function A(){C.push("/register")}function B(){C.push("/reset")}return r((()=>{})),(e,a)=>{const l=u("el-input"),s=u("el-form-item"),o=u("el-button"),r=u("el-checkbox"),f=u("el-link"),y=u("el-form");return t(),i("div",h,[d("div",_,[a[10]||(a[10]=d("div",{class:"login-header"},[d("h2",{class:"login-title"},"欢迎登录")],-1)),d("div",w,[d("div",k,[d("span",{class:n({"tab-item":!0,active:"0"===U.value}),onClick:a[0]||(a[0]=e=>U.value="0")},"密码登录",2)]),d("div",null,[m(y,{model:q.value,rules:L.value,ref_key:"loginFormRef",ref:I,"label-width":"0"},{default:c((()=>[m(s,{prop:"mobile"},{default:c((()=>[m(l,{modelValue:q.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>q.value.mobile=e),placeholder:"请输入手机号",maxlength:"11",size:"large"},null,8,["modelValue"])])),_:1}),"0"===U.value?(t(),v(s,{key:0,prop:"password"},{default:c((()=>[m(l,{modelValue:q.value.password,"onUpdate:modelValue":a[2]||(a[2]=e=>q.value.password=e),placeholder:"请输入密码","show-password":"",size:"large"},null,8,["modelValue"])])),_:1})):p("",!0),"1"===U.value?(t(),v(s,{key:1,prop:"code"},{default:c((()=>[m(l,{modelValue:q.value.code,"onUpdate:modelValue":a[3]||(a[3]=e=>q.value.code=e),placeholder:"请输入验证码",maxlength:"6",size:"large"},{suffix:c((()=>[m(o,{type:"primary",disabled:j.value>0,onClick:$},{default:c((()=>[g(b(j.value>0?j.value+"s后重试":"获取验证码"),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1})):p("",!0),"0"===U.value?(t(),i("div",V,[m(r,{modelValue:q.value.rememberMe,"onUpdate:modelValue":a[4]||(a[4]=e=>q.value.rememberMe=e)},{default:c((()=>a[5]||(a[5]=[g("记住密码")]))),_:1},8,["modelValue"]),m(f,{type:"primary",onClick:B},{default:c((()=>a[6]||(a[6]=[g("忘记密码?")]))),_:1})])):p("",!0),d("div",x,[m(o,{type:"primary",style:{width:"100%"},onClick:T,loading:z.value},{default:c((()=>a[7]||(a[7]=[g("登录")]))),_:1},8,["loading"])])])),_:1},8,["model","rules"])])]),d("div",M,[a[9]||(a[9]=d("span",{class:"no-account"},"还没有账号?",-1)),m(f,{type:"primary",onClick:A},{default:c((()=>a[8]||(a[8]=[g("立即注册")]))),_:1})])])])}}},[["__scopeId","data-v-e671e446"]]);export{C as default};
